<h2>Your Cart</h2>

{% if cart_items %}
<table>
  <thead>
    <tr>
      <th>Product</th>
      <th>Price</th>
      <th>Quantity</th>
      <th>Subtotal</th>
    </tr>
  </thead>
  <tbody>
    {% for item in cart_items %}
    <tr>
      <td>{{ item.product.name }}</td>
      <td>${{ item.product.price }}</td>
      <td>{{ item.quantity }}</td>
      <td>${{ item.product.price|floatformat:2|add:item.quantity|floatformat:2 }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h3>Total: ${{ total_price }}</h3>

<!-- Payment Button -->
{% if user.is_authenticated %}
  <form action="{% url 'products:checkout' %}" method="post">
    {% csrf_token %}
    <button type="submit" class="btn">üí≥ Proceed to Payment</button>
  </form>
{% else %}
  <div class="login-prompt">
    <p>To complete your purchase, please log in or register:</p>
    <a href="{% url 'accounts:login' %}" class="btn">üîê Login</a>
    <a href="{% url 'accounts:register' %}" class="btn">üìù Register</a>
  </div>
{% endif %}

{% else %}
<p>Your cart is empty.</p>
{% endif %}

<style>
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
}
th, td {
  padding: 10px;
  border: 1px solid #ccc;
  text-align: left;
}
.btn {
  display: inline-block;
  margin: 10px 5px;
  padding: 10px 16px;
  background-color: #007bff;
  color: white;
  text-decoration: none;
  border-radius: 4px;
}
.login-prompt {
  margin-top: 20px;
  padding: 15px;
  background-color: #f9f9f9;
  border: 1px solid #ccc;
}
</style>
